<script>
  // Save all snippets to cookies
  function saveSnippets() {
    const snippets = [];
    document.querySelectorAll("#list .snippet span").forEach(span => {
      snippets.push(span.textContent);
    });
    // Save as JSON string, expires in 7 days
    document.cookie = `snippets=${encodeURIComponent(JSON.stringify(snippets))}; max-age=${7*24*60*60}; path=/`;
  }

  // Load snippets from cookies
  function loadSnippets() {
    const cookie = document.cookie.split('; ').find(row => row.startsWith('snippets='));
    if (!cookie) return;
    const snippets = JSON.parse(decodeURIComponent(cookie.split('=')[1]));
    snippets.forEach(text => createSnippetElement(text));
  }

  // Create a snippet element (used for add and load)
  function createSnippetElement(text) {
    const div = document.createElement("div");
    div.className = "snippet";

    const deleteBtn = document.createElement("button");
    deleteBtn.textContent = "ðŸ—‘ï¸";
    deleteBtn.className = "icon-btn";
    deleteBtn.title = "Delete";
    deleteBtn.onclick = () => {
      div.remove();
      saveSnippets();
    };

    const span = document.createElement("span");
    span.textContent = text;

    const copyBtn = document.createElement("button");
    copyBtn.textContent = "Copy";
    copyBtn.onclick = () => navigator.clipboard.writeText(text);

    div.appendChild(deleteBtn);
    div.appendChild(span);
    div.appendChild(copyBtn);

    document.getElementById("list").appendChild(div);
  }

  // Add snippet from textarea
  function addSnippet() {
    const text = document.getElementById("input").value.trim();
    if (!text) return;
    createSnippetElement(text);
    document.getElementById("input").value = "";
    saveSnippets();
  }

  // Load snippets on page load
  window.onload = loadSnippets;
</script>
